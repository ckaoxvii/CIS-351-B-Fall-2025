---
title: "Introduction to Data Visualization"
subtitle: "Week 10 Lectures 1"
author: "Your Name"
format: 
  html:
    -embed-resources: true
---

```{r}
#| message: false
#| warning: false

library(tidyverse)

library(janitor)

library(palmerpenguins)

library(readxl)

library(gapminder)

library(gt)

conflicted::conflicts_prefer(palmerpenguins::penguins)

conflicted::conflicts_prefer(dplyr::filter)
```

## Bar Charts/Barplots

Bar charts to categorical variables are similar to histograms for numerical variables. In general, the ordering of the bars do not matter, unless they are ordinal factors. Additionally, the bars in a bar chart do not touch each other.

```{r}
names(penguins)
```

**Example 1.** Create a bar chart of penguins' species.

```{r}
unique(penguins$species) # unique species in `species` column
```

_Method 1_: Base R

To plot a bar chart using base R, we first need to summary the `species` column.

```{r}
species <- penguins |> 
  select(species) |> 
  summarize(
    count = n(),
    .by = species
  )

species
```

```{r}
plot_species <- barplot(
  height = species$count,
  names.arg = species$species
)

plot_species
```

_Method 2:_ Using `{ggplot2}`

```{r}
plot_species_2 <- penguins |> 
  ggplot(
    aes(x = species)
  ) +
  geom_bar() 

plot_species_2
```

```{r}
plot_species_2a <- penguins |> 
  ggplot(
    aes(x = species)
  ) +
  geom_bar(
    color = 'blue',
    fill = 'skyblue'
  ) +
  labs(
    title = 'Count by Species',
    x = 'Species',
    y = 'Count'
  )

plot_species_2a
```

```{r}
plot_species_2a +
  theme_bw()
```

```{r}
plot_species_2a +
  theme_classic() 
```

```{r}
species |>
  ggplot(
    aes(x = species, y = count)
  ) +
  geom_bar(
    stat = 'identity',
    fill = 'skyblue',
    color = 'blue'
  ) +
  geom_text(
    aes(
      label = count,
      vjust = -0.75
    )
  ) +
  ylim(0, 170) +
  labs(
    x = 'Species',
    y = 'Count'
  )
```

```{r}
species |>
  ggplot(
    aes(x = species, y = count, fill = species)
  ) +
  geom_bar(
    stat = 'identity'
  ) +
  geom_text(
    aes(
      label = count,
      vjust = -0.75
    )
  ) +
  ylim(0, 170) +
  labs(
    x = 'Species',
    y = 'Count'
  )
```

```{r}
species |>
  ggplot(
    aes(x = species, y = count, fill = species)
  ) +
  geom_bar(
    stat = 'identity'
  ) +
  scale_fill_brewer(palette = 'Dark2') +
  geom_text(
    aes(
      label = count,
      vjust = -0.75
    )
  ) +
  ylim(0, 170) +
  labs(
    x = 'Species',
    y = 'Count'
  ) +
  theme_bw()
```


```{r}
species |>
  ggplot(
    aes(x = species, y = count, fill = species)
  ) +
  geom_bar(
    stat = 'identity'
  ) +
  scale_fill_manual(values = 
    c('#A90533', '#FFB500', '#69625D')
  ) +
  geom_text(
    aes(
      label = count,
      vjust = -0.75
    )
  ) +
  ylim(0, 170) +
  labs(
    x = 'Species',
    y = 'Count'
  ) +
  theme_bw()
```